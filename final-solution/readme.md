Here is the final solution to this problem
